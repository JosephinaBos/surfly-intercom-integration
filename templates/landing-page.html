<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Intercom Test Page</title>
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='style.css') }}">
</head>
<body>
  <h1>Intercom Test Page</h1>
  <button class="basic-button" id="btn-end-session" onclick="sessionEnd()">End session</button>

  <script>
    // Add the Surfly snippet -->
    (function(s,u,r,f,l,y){s[f]=s[f]||{init:function(){s[f].q=arguments}};
    l=u.createElement(r);y=u.getElementsByTagName(r)[0];l.async=1;
    l.src='https://surfly.com/surfly.js';y.parentNode.insertBefore(l,y);})
    (window,document,'script','Surfly');

    // Implement the Surfly init code, ADD YOUR OWN WIDGET KEY
    Surfly.init({widget_key:'24f023888ca9419484b74f10eca984b2'}, function(init) {
      if (init.success) {
        if (Surfly.isInsideSession) {
          // Inside the session, display the btn-end-session
          document.getElementById('btn-end-session').style.display = "block";
        }

        }
    });


    function sessionStart() {
      var settings = {
        block_until_agent_joins: false,
        hide_until_agent_joins: true,
        start_docked: true,
        cookie_transfer_enabled: true,
        cookie_transfer_proxying: false,
        chat_integration: "intercom",
        splash: false
      };
      Surfly.session(settings).startLeader();
    }
    // Function that ends the session, so that it can be applied to the "end Session"-button
    function sessionEnd() {
      Surfly.currentSession.end();
    }
  </script>
  <script>
  window.intercomSettings = {
    app_id: "34243f4a3eeaeec18e497f2ab9d722b6fcd5957b"
  };
</script>
<script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/34243f4a3eeaeec18e497f2ab9d722b6fcd5957b';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();</script>
</body>
</html>
